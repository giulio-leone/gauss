"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[710],{9420(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/guardrails","title":"GuardrailsPlugin","description":"Input/output validation, content filtering, and PII detection","source":"@site/docs/plugins/guardrails.md","sourceDirName":"plugins","slug":"/plugins/guardrails","permalink":"/onegenui-deep-agents/docs/plugins/guardrails","draft":false,"unlisted":false,"editUrl":"https://github.com/giulio-leone/onegenui-deep-agents/tree/main/docs/docs/plugins/guardrails.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"GuardrailsPlugin","description":"Input/output validation, content filtering, and PII detection"},"sidebar":"tutorialSidebar","previous":{"title":"Plugins","permalink":"/onegenui-deep-agents/docs/plugins/"},"next":{"title":"WorkflowPlugin","permalink":"/onegenui-deep-agents/docs/plugins/workflow"}}');var r=n(4848),o=n(8453);const s={sidebar_position:1,title:"GuardrailsPlugin",description:"Input/output validation, content filtering, and PII detection"},a="GuardrailsPlugin",l={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Content Filters",id:"content-filters",level:2},{value:"Built-in: PII Filter",id:"built-in-pii-filter",level:3},{value:"Custom Content Filter",id:"custom-content-filter",level:3},{value:"Custom Validators",id:"custom-validators",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Hooks Used",id:"hooks-used",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"guardrailsplugin",children:"GuardrailsPlugin"})}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"GuardrailsPlugin"})," validates agent inputs and outputs using Zod schemas, applies content filters, and can detect PII patterns."]}),"\n",(0,r.jsx)(t.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { DeepAgent, createGuardrailsPlugin, createPiiFilter } from "@giulio-leone/gaussflow-agent";\nimport { z } from "zod";\n\nconst agent = DeepAgent.create({\n  model: openai("gpt-4o"),\n  instructions: "You are a helpful assistant.",\n})\n  .use(createGuardrailsPlugin({\n    inputSchema: z.string().min(1).max(10000),\n    outputSchema: z.string().max(50000),\n    contentFilters: [createPiiFilter()],\n    toolSchemas: {\n      write_file: z.object({\n        path: z.string(),\n        content: z.string().max(100000),\n      }),\n    },\n    onFailure: "throw",\n  }))\n  .build();\n'})}),"\n",(0,r.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'interface GuardrailsPluginOptions {\n  inputSchema?: ZodType;                         // Validate the input prompt\n  outputSchema?: ZodType;                        // Validate the output text\n  toolSchemas?: Record<string, ZodType>;          // Per-tool argument validation\n  contentFilters?: ContentFilter[];               // Content filters for input/output\n  inputValidators?: Array<(prompt: string) => string | null>;  // Custom input validators\n  outputValidators?: Array<(output: string) => string | null>; // Custom output validators\n  onFailure?: "throw" | "warn";                  // Action on failure (default: "throw")\n  validator?: ValidationPort;                     // Custom validation adapter\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"content-filters",children:"Content Filters"}),"\n",(0,r.jsx)(t.p,{children:"Content filters test strings against patterns:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"interface ContentFilter {\n  readonly name: string;\n  test(content: string): boolean;\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"built-in-pii-filter",children:"Built-in: PII Filter"}),"\n",(0,r.jsx)(t.p,{children:"Detects email addresses, SSNs, and credit card numbers:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { createPiiFilter } from "@giulio-leone/gaussflow-agent";\n\nconst piiFilter = createPiiFilter();\npiiFilter.test("user@example.com"); // true\npiiFilter.test("Hello world");      // false\n'})}),"\n",(0,r.jsx)(t.h3,{id:"custom-content-filter",children:"Custom Content Filter"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'const profanityFilter: ContentFilter = {\n  name: "profanity",\n  test(content: string): boolean {\n    const banned = ["badword1", "badword2"];\n    return banned.some((w) => content.toLowerCase().includes(w));\n  },\n};\n'})}),"\n",(0,r.jsx)(t.h2,{id:"custom-validators",children:"Custom Validators"}),"\n",(0,r.jsxs)(t.p,{children:["Return ",(0,r.jsx)(t.code,{children:"null"})," for valid input, or an error message string:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'const agent = DeepAgent.create({ model, instructions: "..." })\n  .use(createGuardrailsPlugin({\n    inputValidators: [\n      (prompt) => prompt.length < 5 ? "Prompt too short" : null,\n    ],\n    outputValidators: [\n      (output) => output.includes("TODO") ? "Output contains incomplete work" : null,\n    ],\n  }))\n  .build();\n'})}),"\n",(0,r.jsx)(t.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(t.p,{children:["When ",(0,r.jsx)(t.code,{children:'onFailure: "throw"'})," (default), a ",(0,r.jsx)(t.code,{children:"GuardrailsError"})," is thrown:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { GuardrailsError } from "@giulio-leone/gaussflow-agent";\n\ntry {\n  await agent.run(prompt);\n} catch (error) {\n  if (error instanceof GuardrailsError) {\n    console.log(error.code); // "input_validation" | "output_validation" | "content_filter" | "tool_validation"\n    console.log(error.message);\n  }\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"hooks-used",children:"Hooks Used"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Hook"}),(0,r.jsx)(t.th,{children:"Purpose"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"beforeRun"})}),(0,r.jsx)(t.td,{children:"Validates input prompt against schema, content filters, and custom validators"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"afterRun"})}),(0,r.jsx)(t.td,{children:"Validates output text against schema, content filters, and custom validators"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"beforeTool"})}),(0,r.jsx)(t.td,{children:"Validates tool arguments against per-tool schemas"})]})]})]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>a});var i=n(6540);const r={},o=i.createContext(r);function s(e){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);